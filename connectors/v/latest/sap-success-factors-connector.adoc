= SAP Success Factors Connector
:imagesdir: _images

_Select_

The Mule Connector for SuccessFactors provides full support to query, create, update, and delete entities using the ODATA API exposed by SuccessFactors. 

This connector lets you perform operations to:

* Authorize or unauthorize server access.
* Create, update, and delete entities.
* Retrieve a single entity or query multiple entities.
* Associate and disassociate entities.
* Execute actions.

== Prerequisites

This document assumes that you are familiar with SuccessFactors, Mule, Anypoint Connectors, and the Anypoint Studio Essentials. 

To use this connector you need the following:

* A developer account or other valid SAP SuccessFactors instance.
* MuleSoft Enterprise License.

For hardware and software requirements and compatibility
information, see the Connector Release Notes.

To use this connector with Maven, view the pom.xml dependency information in
the Dependency Snippets in Anypoint Exchange.


== What's New in this Connector

This version of the connector adds support for Mule 4.x.

This connector supports ODATA API exposed by the SuccessFactors.

== Supported Operations

The SuccessFactors connector supports the following outbound operations:

* Create Entity
* Create Multiple Entities
* Delete Entity
* Delete Multiple Entities
* Disassociate Links
* Get Entity Metadata
* Get List Of Entities
* Get Metadata
* Invoke
* Invoke Function
* Retrieve Entity
* Retrieve Multiple
* Retrieve Multiple By Query
* Update Entity By Merge
* Update Entity By Replace
* Update Multiple Entities By Merging
* Update Multiple Entities By Replacing
* Upsert Multiple Entities

== To Connect in Design Center

In Design Center, click a trigger such as HTTP Listener or Scheduler.

image:success-factors-trigger.png[]

To create an HTTP global element for the connector, set these fields:

. Select the plus sign to add a component.
. Select the HTTP connector as a component.
. Configure these fields:
+
image:success-factors-http-listener.png[]
+
** Protocol: Protocol selected for the HTTP endpoint, it can be HTTP or HTTPS (secure).
** Host: IP address where your Mule application listens for requests.
** Port: Port address where your Mule application listens for requests.
** Base Path: Path where your Mule application listens for requests.
+
. Select the plus sign to add a component.
+
image:success-factors-plus.png[]
+
. Select the connector as a component.
. Select the desired operation.
. Configure the global element for the connector.
+
Basic Connection:
+
image:success-factors-conf1.png[]
+
image:success-factors-conf2.png[]
+
** Company ID - Enter the ID of the organization in SuccessFactors which information you wish to manage.
** Username - Username used to initialize the session.
** Password - Password used to authenticate the user.
** Data Center's End Point URL - The URL of your organization SuccessFactors instance web API (secured resource). This must be the root URI like the way mentioned in above image.
+
OAuth Connection:
+
image:success-factors-conf3.png[]
+
image:success-factors-conf4.png[]
+
** Company ID - Enter the ID of the organization in SuccessFactors which information you wish to manage.
** Client ID - The application ID assigned to your app when you registered it.
** User Name - Username used to initialize the session.
** Private Key - Password used to authenticate the user.
** User Email - Checkbox.
** Data Center's End Point URL - The URL of your organization SuccessFactors instance web API (secured resource). This must be the root URI like the way mentioned in above image for basic connection.


== Connect in Anypoint Studio 7

You can use this connector in Anypoint Studio by first downloading it from Exchange
and configuring it as needed.

=== Install Connector in Studio

. In Anypoint Studio, click the Exchange icon in the Studio taskbar.
. Click Login in Anypoint Exchange.
. Search for this connector and click Install.
. Follow the prompts to install this connector.

When Studio has an update, a message displays in the lower right corner,
which you can click to install the update.

=== Configure in Studio

. Open your Mule project in Anypoint Studio.
. Add the connector as a dependency in the pom.xml file:
+
[source,xml,linenums]
----
<dependency>
    <groupId>com.mulesoft.connectors</groupId>
    <artifactId>mule-successfactors-connector</artifactId>
    <version>3.0.0</version>
    <classifier>mule-plugin</classifier>
</dependency>
----

== To Configure the SuccessFactors Connector Global Element

To use the SuccessFactors connector in a Mule application, you must configure a global SuccessFactors configuration element that can be used by as many SuccessFactors connectors as
you require for your application.

. Click the Global Elements tab at the base of the canvas.
. In the Global Configuration Elements screen, click Create. Following window would be displayed.
+
image:success-factors-global-config-wizard.png[Global Element Configuration Wizard]
+
. In the Choose Global Type wizard, expand Connector Configuration, select SuccessFactors connector Config, and click OK.
+
The following configuration screen  for Basic Connection appears.
+
image:success-factors-basic-config.png[Basic Connection screen]
+
. Configure these properties:
+
[%header%autowidth.spread]
|===
|Parameter|Description
|CompanyID|Your company ID
|User Name|User name to connect
|Password|Password to connect
|Data Center's Endpoint URL|SuccessFactors Web API URL
|Enable Session Reuse|The session is alive.
|===
+
. In the Choose Global Type wizard, expand Connector Configuration and select SuccessFactors connector Config and click OK.
+
The following configuration screen for OAuth Connection appears.
+
image:success-factors-oauth-config.png[OAuth Connection screen]
+
. Configure these properties:
+
[%header%autowidth.spread]
|===
|Parameter |Description
|Company ID |Your company ID
|Client ID |Your client ID
|User ID |User name to connect
|Private key |Access token
|Data Center's Endpoint URL |SuccessFactors Web API URL
|Use Email |false
|===
+
Notes:
+
* In the Basic and OAuth configuration screens above, the placeholder values refer to a configuration file `mule-artifact.properties` in the
`src/main/resources` folder of your project.
* You can either enter your credentials into the global configuration properties, or reference a configuration file that contains these values. 
* For simpler maintenance and better re-usability of your project, Mule recommends that you use a configuration file. Keeping these values in a separate file is useful if you need to deploy to different environments, such as production, development, and QA, where your access credentials differ. 
+
. Click OK to save the global connector configurations.

== Use Case: Set Up and Run in Studio

. In Anypoint Studio, click File > New > Mule Project.
. Specify a Project Name and click Finish.
. Search for "http" and drag the HTTP connector to the canvas. Click the green
plus sign next to Connector Configuration, and click OK in the menu to accept the default values.
. Drag the SuccessFactors connector Operation to the canvas.
Click the green plus next to Connector Configuration, and specify your access credentials.
. Click a connection strategy for authentication:
+
** Basic Connection
** OAuth Connection

=== To Configure Basic Connection

Configure Basic connection as described in the previous section, To Configure the SuccessFactors Connector Global Element.

=== To Configure OAuth Connection

Configure an OAuth connection as described in the previous section, To Configure the SuccessFactors Connector Global Element.

== To Run a Flow

. In Package Explorer, right clickÂ your project's name, and click Run As > Mule Application.
. Check the console to see when the application starts. You should see messages such as these if no errors occur:

[source,xml,linenums]
----
************************************************************
INFO  2018-05-14 22:12:42,003 [main] org.mule.module.launcher.DeploymentDirectoryWatcher:
++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
+ Mule is up and kicking (every 5000ms)                    +
++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
INFO  2018-05-14 22:12:42,006 [main] org.mule.module.launcher.StartupSummaryDeploymentListener:
**********************************************************
*  - - + DOMAIN + - -               * - - + STATUS + - - *
**********************************************************
* default                           * DEPLOYED           *
**********************************************************

************************************************************************
* - - + APPLICATION + - -   * - - + DOMAIN + - -  * - - + STATUS + - - *
************************************************************************
* myapp                     * default             * DEPLOYED           *
************************************************************************
----

== Example: Success Factors

This example demonstrates the use of SuccessFactors Connector.

To build and run this demo project, you need:

* Anypoint Studio with at least the Mule 4.0 Runtime.
* SuccessFactors Connector v3.0.0 or later.
* Credentials to send ODATA API requests.

=== To Test the Flow

. Import the demo project into your workspace using Anypoint Exchange or using the Import command in the File menu.
. Specify your Basic or OAuth credentials in the `/src/main/app/mule-app.properties` file:
. Run the project in Studio.
. Type `localhost:8081` in your browser to access the selection menu of the demo.
. Optionally you can configure the Connection Timeout and Read Timeout.
+
The Connection Timeout is the timeout in making the initial connection with the server.
The Read Timeout is the timeout on waiting to read data from the server.

You can use the selection menu from `+http://localhost:8081+` to test the flows.

=== Example XML Flow

[source,xml,linenums]
----
<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:successfactors="http://www.mulesoft.org/schema/mule/successfactors" 
xmlns:http="http://www.mulesoft.org/schema/mule/http"
	xmlns="http://www.mulesoft.org/schema/mule/core"
	xmlns:doc="http://www.mulesoft.org/schema/mule/documentation" 
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
	xsi:schemaLocation="http://www.mulesoft.org/schema/mule/core 
	http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/http 
http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd
http://www.mulesoft.org/schema/mule/successfactors 
http://www.mulesoft.org/schema/mule/successfactors/current/mule-successfactors.xsd">
	<http:listener-config name="HTTP_Listener_config" doc:name="HTTP Listener config">
		<http:listener-connection host="localhost" port="8081" />
	</http:listener-config>
	<successfactors:config name="SuccessFactors_Configuration" 
	doc:name="SuccessFactors Configuration" >
		<successfactors:basic-connection 
		companyId="${config.companyID}" 
		userName="${config.userName}" 
		password="${config.password}" 
		endpointUrl="${config.url}" />
	</successfactors:config>
	<flow name="ListFlow">
		<http:listener doc:name="Listener" config-ref="HTTP_Listener_config" path="/list"/>
		<successfactors:get-list-of-entities doc:name="Get list of entities"
		config-ref="SuccessFactors_Configuration"/>
		<set-payload value="#[payload]" doc:name="Set Payload" mimeType="application/json"/>
	</flow>
	<flow name="sfdemoFlow">
		<http:listener doc:name="Listener"
		config-ref="HTTP_Listener_config" path="/query"/>
		<successfactors:retrieve-multiple entitySetName="User" doc:name="Retrieve multiple" 
		config-ref="SuccessFactors_Configuration"/>
		<set-payload value="#[payload]" doc:name="Set Payload" mimeType="application/json"/>
	</flow>
</mule>
----

== Use Case: Success Factors Batch Operations

image:success-factors-batch-ops-1.png[Batch Operations Studio 7 Flow]
image:success-factors-batch-ops-2.png[Batch Operations Studio 7 Flow]
image:success-factors-batch-ops-3.png[Batch Operations Studio 7 Flow]
image:success-factors-batch-ops-4.png[Batch Operations Studio 7 Flow]

[source,xml,linenums]
----
<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:successfactors="http://www.mulesoft.org/schema/mule/successfactors" 
    xmlns:ee="http://www.mulesoft.org/schema/mule/ee/core"
      xmlns:http="http://www.mulesoft.org/schema/mule/http"
      xmlns="http://www.mulesoft.org/schema/mule/core" 
      xmlns:doc="http://www.mulesoft.org/schema/mule/documentation" 
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
      xsi:schemaLocation="http://www.mulesoft.org/schema/mule/core 
      http://www.mulesoft.org/schema/mule/core/current/mule.xsd
    http://www.mulesoft.org/schema/mule/http 
    http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd
    http://www.mulesoft.org/schema/mule/ee/core 
    http://www.mulesoft.org/schema/mule/ee/core/current/mule-ee.xsd
    http://www.mulesoft.org/schema/mule/successfactors 
    http://www.mulesoft.org/schema/mule/successfactors/current/mule-successfactors.xsd">
    <http:listener-config name="HTTP_Listener_config" doc:name="HTTP Listener config">
        <http:listener-connection host="localhost" port="8081" />
    </http:listener-config>
    <successfactors:config name="SuccessFactors_Configuration" 
        doc:name="SuccessFactors Configuration">
        <successfactors:basic-connection 
            companyId="${config.companyId}" 
            userName="${config.userName}" 
            password="${config.password}" 
            endpointUrl="${config.endpointUrl}" />
    </successfactors:config>
    <configuration-properties file="automation-credentials.properties"/>
    <flow name="SF-BATCH-OPERATIONS-HTML-FLOW">
        <http:listener doc:name="Listener" config-ref="HTTP_Listener_config" path="/"/>
        <parse-template doc:name="Parse Template" location="form.html"/>
    </flow>
    <flow name="Update-By-Merge">
        <http:listener doc:name="Listener" config-ref="HTTP_Listener_config" path="/merge"/>
        <ee:transform doc:name="Transform Message">
            <ee:message >
                <ee:set-payload ><![CDATA[%dw 2.0
output application/java
---
[{
    "userId":"NewUser2",
     "email":"newuser22@example.com",
     "firstName":"newone",
     "lastName":"newonetoo"
},{
    "userId":"NewUser3",
     "email":"newuser33@example.com",
     "firstName":"agnuin",
     "lastName":"timbuk-2"
}]]]></ee:set-payload>
            </ee:message>
        </ee:transform>
        <successfactors:update-multiple-entities-by-merging 
            doc:name="Update multiple entities by merging" 
            config-ref="SuccessFactors_Configuration" 
            entitySetName="User"/>
        <set-variable value="#[payload.successful]" doc:name="Set Variable" 
            variableName="successStatus"/>
        <logger level="INFO" doc:name="Logger" 
            message="Is operation successful:- #[payload.successful]"/>
        <foreach doc:name="For Each" collection="#[payload.*items]">
            <logger level="INFO" doc:name="Logger" message="#[payload.payload.body]" />
        </foreach>
        <ee:transform doc:name="Transform Message">
            <ee:message >
                <ee:set-payload ><![CDATA[%dw 2.0
output application/json
---
{
    successStatus: vars.successStatus
}]]></ee:set-payload>
            </ee:message>
        </ee:transform>
        <logger level="INFO" doc:name="Logger" message="#[vars.successStatus]"/>
    </flow>
    <flow name="Create-Multiple" >
        <http:listener doc:name="Listener" config-ref="HTTP_Listener_config" path="/create"/>
        <ee:transform doc:name="Transform Message">
            <ee:message >
                <ee:set-payload ><![CDATA[%dw 2.0
output application/java
---
[{
	"effectiveStatus":"I",
	 "effectiveStartDate":"2018-07-08T00:00:00" as Date {class:"java.util.Date"},
	 "vendorCode":"ABC123"
},
{
	"effectiveStatus":"I",
	 "effectiveStartDate":"2018-07-08T00:00:00" as Date {class:"java.util.Date"},
	 "vendorCode":"ABC456"
}]]]></ee:set-payload>
            </ee:message>
        </ee:transform>
        <successfactors:create-multiple-entities entitySetName="VendorInfo" 
            doc:name="Create multiple entities" config-ref="SuccessFactors_Configuration"/>
        <set-variable value="#[payload.successful]" doc:name="Set Variable" 
            variableName="successStatus"/>
        <logger level="INFO" doc:name="Logger" 
            message="Is operation successful:- #[payload.successful]"/>
        <foreach doc:name="For Each" collection="#[payload.*items]">
            <logger level="INFO" doc:name="Logger" message="#[payload.payload.body]" />
        </foreach>
        <ee:transform doc:name="Transform Message">
            <ee:message >
                <ee:set-payload ><![CDATA[%dw 2.0
output application/json
---
{
    successStatus: vars.successStatus
}]]></ee:set-payload>
            </ee:message>
        </ee:transform>
        <logger level="INFO" doc:name="Logger" message="#[vars.successStatus]"/>
    </flow>
    <flow name="Update-By-Replace">
        <http:listener doc:name="Listener" config-ref="HTTP_Listener_config" path="/replace"/>
        <ee:transform doc:name="Transform Message">
            <ee:message >
                <ee:set-payload ><![CDATA[%dw 2.0
output application/java
---
[{
	"effectiveStatus":"A",
	 "effectiveStartDate":"2018-07-07T00:00:00" as Date {class:"java.util.Date"},
	 "vendorCode":"ABC123"
},
{
	"effectiveStatus":"A",
	 "effectiveStartDate":"2018-07-07T00:00:00" as Date {class:"java.util.Date"},
	 "vendorCode":"ABC456"
}]]]></ee:set-payload>
            </ee:message>
        </ee:transform>
        <successfactors:update-multiple-entities-by-replacing entitySetName="VendorInfo" 
            doc:name="Update multiple entities by replacing" 
            config-ref="SuccessFactors_Configuration"/>
        <set-variable value="#[payload.successful]" doc:name="Set Variable" 
            variableName="successStatus"/>
        <logger level="INFO" doc:name="Logger" 
            message="Is operation successful:- #[payload.successful]"/>
        <foreach doc:name="For Each" collection="#[payload.*items]">
            <logger level="INFO" doc:name="Logger" message="#[payload.payload.body]" />
        </foreach>
        <ee:transform doc:name="Transform Message" >
            <ee:message >
                <ee:set-payload ><![CDATA[%dw 2.0
output application/json
---
{
    successStatus: vars.successStatus
}]]></ee:set-payload>
            </ee:message>
        </ee:transform>
        <logger level="INFO" doc:name="Logger" message="#[vars.successStatus]"/>
    </flow>
    <flow name="Upsert-Multiple-Entities">
        <http:listener doc:name="Listener" config-ref="HTTP_Listener_config" path="/upsert"/>
        <ee:transform doc:name="Transform Message">
            <ee:message >
                <ee:set-payload ><![CDATA[%dw 2.0
output application/java
---
[{
	 "effectiveStatus":"I",
	 "effectiveStartDate":"2018-07-08T00:00:00" as Date {class:"java.util.Date"},
	 "vendorCode":"ABC123456"
},
{
	"effectiveStatus":"I",
	 "effectiveStartDate":"2018-07-07T00:00:00" as Date {class:"java.util.Date"},
	 "vendorCode":"ABC123"
}]]]></ee:set-payload>
            </ee:message>
        </ee:transform>
        <successfactors:upsert-multiple-entities entitySetName="VendorInfo" 
            doc:name="Upsert multiple entities" config-ref="SuccessFactors_Configuration"/>
        <set-variable value="#[payload.successful]" doc:name="Set Variable"
            variableName="successStatus"/>
        <logger level="INFO" doc:name="Logger" 
            message="Is operation successful:-  #[payload.successful]"/>
        <foreach doc:name="For Each" collection="#[payload.*items]">
            <logger level="INFO" doc:name="Logger" message="#[payload.payload.body]" />
        </foreach>
        <ee:transform doc:name="Transform Message">
            <ee:message >
                <ee:set-payload ><![CDATA[%dw 2.0
output application/json
---
{
    successStatus: vars.successStatus
}]]></ee:set-payload>
            </ee:message>
        </ee:transform>
        <logger level="INFO" doc:name="Logger" message="#[vars.successStatus]"/>
    </flow>
    <flow name="Delete-Multiple-Entities">
        <http:listener doc:name="Listener" config-ref="HTTP_Listener_config" path="/delete"/>
        <ee:transform doc:name="Transform Message">
            <ee:message >
                <ee:set-payload ><![CDATA[%dw 2.0
output application/java
---
[
"effectiveStartDate=datetime'2018-07-07T00:00:00',vendorCode='ABC123'" as String,
"effectiveStartDate=datetime'2018-07-07T00:00:00',vendorCode='ABC456'" as String,
"effectiveStartDate=datetime'2018-07-08T00:00:00',vendorCode='ABC123456'" as String
]]]></ee:set-payload>
            </ee:message>
        </ee:transform>
        <successfactors:delete-multiple-entities entitySetName="VendorInfo" 
            doc:name="Delete multiple entities" config-ref="SuccessFactors_Configuration"/>
        <set-variable value="#[payload.successful]" doc:name="Set Variable"
            variableName="successStatus"/>
        <logger level="INFO" doc:name="Logger" 
            dmessage="Is operation successful:-  #[payload.successful]"/>
        <foreach doc:name="For Each" collection="#[payload.*items]">
            <logger level="INFO" doc:name="Logger" message="#[payload.payload.body]" />
        </foreach>
        <ee:transform doc:name="Transform Message">
            <ee:message >
                <ee:set-payload ><![CDATA[%dw 2.0
output application/json
---
{
    successStatus: vars.successStatus
}]]></ee:set-payload>
            </ee:message>
        </ee:transform>
        <logger level="INFO" doc:name="Logger" message="#[vars.successStatus]"/>
    </flow>

    <flow name="BATCH-User-Create-Multiple">
        <http:listener doc:name="Listener" config-ref="HTTP_Listener_config" 
            path="/userCreateMultiple"/>
        <ee:transform doc:name="Transform Message">
            <ee:message >
                <ee:set-payload ><![CDATA[%dw 2.0
output application/java
---
[{
	username : "ohwhatagooseiam",
    password : "mypwd",
    hireDate : "2018-02-23" as Date {class:"java.util.Date"},
    gender : "M",
    status : "active",
    userId : "ohwhatagooseiam999",
    firstName : "test-goose",
    lastName : "Man",
    email : "ohwhatagooseiam@example.com",
    department : "HRDepartment",
    timeZone : "PST",
    jobCode : "SW",
    location : "NY",
    division : "IT",
    hr : {
        "__metadata" : {
            "uri": "User('NO_HR')"
        }
    },
    manager : {
        "__metadata" : {
            "uri": "User('NO_MANAGER')"
        }
}
}]]]></ee:set-payload>
            </ee:message>
        </ee:transform>
        <successfactors:create-multiple-entities doc:name="Create multiple entities" 
            config-ref="SuccessFactors_Configuration" entitySetName="User"/>
        <set-variable value="#[payload.successful]" doc:name="Set Variable" 
            variableName="successStatus"/>
        <logger level="INFO" doc:name="Logger" 
            message="Is operation successful:- #[payload.successful]"/>
        <foreach doc:name="For Each" collection="#[payload.*items]">
            <logger level="INFO" doc:name="Logger" message="#[payload.payload.body]" />
        </foreach>
        <ee:transform doc:name="Transform Message">
            <ee:message >
                <ee:set-payload ><![CDATA[%dw 2.0
output application/json
---
{
    successStatus: vars.successStatus
}]]></ee:set-payload>
            </ee:message>
        </ee:transform>
        <logger level="INFO" doc:name="Logger" message="#[vars.successStatus]"/>
    </flow>
    <flow name="BATCH-USER-Update-By-Replace">
        <http:listener doc:name="Listener" config-ref="HTTP_Listener_config" path="/userMultipleUpdateByReplace"/>
        <ee:transform doc:name="Transform Message">
            <ee:message >
                <ee:set-payload ><![CDATA[%dw 2.0
output application/java
---
[{
	username : "ohwhatagooseiam",
    password : "mypwd",
    hireDate : "2018-02-23" as Date {class:"java.util.Date"},
    gender : "M",
    status : "active",
    userId : "ohwhatagooseiam999",
    firstName : "Hereiam",
    lastName : "RightBesideU",
    email : "ohwhatagooseiam@example.com",
    department : "HRDepartment",
    timeZone : "PST",
    jobCode : "SW",
    location : "NY",
    division : "IT",
    hr : {
        "__metadata" : {
            "uri": "User('NO_HR')"
        }
    },
    manager : {
        "__metadata" : {
            "uri": "User('NO_MANAGER')"
        }
}
}]]]></ee:set-payload>
            </ee:message>
        </ee:transform>
        <successfactors:update-multiple-entities-by-replacing 
            doc:name="Update multiple entities by replacing" 
            config-ref="SuccessFactors_Configuration" entitySetName="User"/>
        <set-variable value="#[payload.successful]" doc:name="Set Variable" 
            variableName="successStatus"/>
        <logger level="INFO" doc:name="Logger" 
            message="Is operation successful:- #[payload.successful]"/>
        <foreach doc:name="For Each" collection="#[payload.*items]">
            <logger level="INFO" doc:name="Logger" message="#[payload.payload.body]" />
        </foreach>
        <ee:transform doc:name="Transform Message">
            <ee:message >
                <ee:set-payload ><![CDATA[%dw 2.0
output application/json
---
{
    successStatus: vars.successStatus
}]]></ee:set-payload>
            </ee:message>
        </ee:transform>
        <logger level="INFO" doc:name="Logger" message="#[vars.successStatus]"/>
    </flow>
    <flow name="BATCH-User-Upsert-Multiple">
        <http:listener doc:name="Listener" config-ref="HTTP_Listener_config" path="/userUpsertMultiple"/>
        <ee:transform doc:name="Transform Message">
            <ee:message >
                <ee:set-payload ><![CDATA[%dw 2.0
output application/java
---
[{
	username : "ohwhatagooseiam",
    password : "mypwd",
    hireDate : "2018-02-23" as Date {class:"java.util.Date"},
    gender : "M",
    status : "active",
    userId : "ohwhatagooseiam990015",
    firstName : "Hereiam",
    lastName : "Rightbesideu",
    email : "ohwhatagooseiam@example.com",
    department : "HRDepartment",
    timeZone : "PST",
    jobCode : "SW",
    location : "NY",
    division : "IT",
    hr : {
        "__metadata" : {
            "uri": "User('NO_HR')"
        }
    },
    manager : {
        "__metadata" : {
            "uri": "User('NO_MANAGER')"
        }
}
}]]]></ee:set-payload>
            </ee:message>
        </ee:transform>
        <successfactors:upsert-multiple-entities doc:name="Upsert multiple entities" 
            config-ref="SuccessFactors_Configuration" entitySetName="User"/>
        <set-variable value="#[payload.successful]" doc:name="Set Variable"
            variableName="successStatus"/>
        <logger level="INFO" doc:name="Logger" 
            message="Is operation successful:- #[payload.successful]"/>
        <foreach doc:name="For Each" collection="#[payload.*items]">
            <logger level="INFO" doc:name="Logger" message="#[payload.payload.body]" />
        </foreach>
        <ee:transform doc:name="Transform Message">
            <ee:message >
                <ee:set-payload ><![CDATA[%dw 2.0
output application/json
---
{
    successStatus: vars.successStatus
}]]></ee:set-payload>
            </ee:message>
        </ee:transform>
        <logger level="INFO" doc:name="Logger" message="#[vars.successStatus]"/>
    </flow>
</mule>
----

== Use Case: Success Factors Operations

image:success-factors-ops-1.png[Operations Studio 7 Flow]
image:success-factors-ops-2.png[Operations Studio 7 Flow]
image:success-factors-ops-3.png[Operations Studio 7 Flow]

[source,xml,linenums]
----
<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:json="http://www.mulesoft.org/schema/mule/json"
	xmlns:successfactors="http://www.mulesoft.org/schema/mule/successfactors" 
	xmlns:ee="http://www.mulesoft.org/schema/mule/ee/core"
	xmlns:http="http://www.mulesoft.org/schema/mule/http"
	xmlns="http://www.mulesoft.org/schema/mule/core" 
	xmlns:doc="http://www.mulesoft.org/schema/mule/documentation" 
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
	xsi:schemaLocation="
	http://www.mulesoft.org/schema/mule/json 
	http://www.mulesoft.org/schema/mule/json/current/mule-json.xsd 
	http://www.mulesoft.org/schema/mule/core 
	http://www.mulesoft.org/schema/mule/core/current/mule.xsd
	http://www.mulesoft.org/schema/mule/http 
	http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd
	http://www.mulesoft.org/schema/mule/ee/core 
	http://www.mulesoft.org/schema/mule/ee/core/current/mule-ee.xsd
	http://www.mulesoft.org/schema/mule/successfactors 
	http://www.mulesoft.org/schema/mule/successfactors/current/mule-successfactors.xsd">
	<http:listener-config name="HTTP_Listener_config" doc:name="HTTP Listener config">
		<http:listener-connection host="localhost" port="8081" />
	</http:listener-config>
	<successfactors:config name="SuccessFactors_Configuration" 
		doc:name="SuccessFactors Configuration" >
		<successfactors:basic-connection 
			companyId="${config.companyId}" 
			userName="${config.userName}" 
			password="${config.password}" 
			endpointUrl="${config.endpointUrl}"/>
	</successfactors:config>
	<configuration-properties file="automation-credentials.properties"/>
	<flow name="sf-operationsFlow">
		<http:listener doc:name="Listener" config-ref="HTTP_Listener_config" path="/"/>
		<parse-template doc:name="Parse Template" location="form.html"/>
	</flow>
	<flow name="Create-Entry-Flow">
		<http:listener doc:name="Listener" config-ref="HTTP_Listener_config" path="/create"/>
		<ee:transform doc:name="Transform Message">
			<ee:message >
				<ee:set-payload ><![CDATA[%dw 2.0
output application/java
---
{
    username : "myusername",
    password : "mypwd",
    hireDate : "2018-02-23" as Date {class:"java.util.Date"},
    gender : "F",
    status : "active",
    userId : attributes.queryParams.userpId,
    firstName : "Me",
    lastName : "Myselfandi",
    email : "me.myselfandi@example.com",
    department : "HRDepartment",
    timeZone : "PST",
    jobCode : "SW",
    location : "NY",
    division : "IT",
    hr : {
        userId : "NO_HR"
    },
    manager : {
        userId : "NO_MANAGER"
    }
}   ]]></ee:set-payload>
			</ee:message>
		</ee:transform>
		<logger level="INFO" doc:name="Logger" message="#[payload]"/>
		<successfactors:create-entity entitySetName="User" doc:name="Create entity" 
			config-ref="SuccessFactors_Configuration"/>
		<logger level="INFO" doc:name="Logger" message="#[payload]"/>
	</flow>
	<flow name="Retrieve-Entity">
		<http:listener doc:name="Listener" config-ref="HTTP_Listener_config" path="/retrieve"/>
		<ee:transform doc:name="Transform Message">
			<ee:message >
				<ee:set-payload ><![CDATA[%dw 2.0
output application/java
---
attributes.queryParams.userId as String]]></ee:set-payload>
			</ee:message>
		</ee:transform>
		<logger level="INFO" doc:name="Logger" message="#[payload]"/>
		<successfactors:retrieve-entity entitySetName="User" doc:name="Retrieve entity" 
			config-ref="SuccessFactors_Configuration"/>
		<ee:transform doc:name="Transform Message">
			<ee:message >
				<ee:set-payload ><![CDATA[%dw 2.0
output application/json
---
payload
]]></ee:set-payload>
			</ee:message>
		</ee:transform>
		<logger level="INFO" doc:name="Logger" message="#[payload]"/>
	</flow>
	<flow name="Get-Metadata">
		<http:listener doc:name="Listener" config-ref="HTTP_Listener_config" path="/metadata"/>
		<successfactors:get-metadata doc:name="Get metadata" 
			config-ref="SuccessFactors_Configuration"/>
		<ee:transform doc:name="Transform Message" >
			<ee:message >
				<ee:set-payload ><![CDATA[%dw 2.0
output application/xml
---
payload]]></ee:set-payload>
			</ee:message>
		</ee:transform>
		<logger level="INFO" doc:name="Logger" message="#[payload]"/>
	</flow>
	<flow name="Invoke-Function">
		<http:listener doc:name="Listener" config-ref="HTTP_Listener_config" path="/invoke"/>
		<ee:transform doc:name="Transform Message">
			<ee:message >
				<ee:set-payload ><![CDATA[%dw 2.0
output application/java
---
{
	"userIds":attributes.queryParams.userFuncId,
	"locale":"en_US"
}]]></ee:set-payload>
			</ee:message>
		</ee:transform>
		<successfactors:invoke-function functionName="getUsersPermissions" 
			httpMethod="GET" doc:name="Invoke function" config-ref="SuccessFactors_Configuration"/>
		<ee:transform doc:name="Transform Message">
			<ee:message >
				<ee:set-payload ><![CDATA[%dw 2.0
output application/json
---
payload]]></ee:set-payload>
			</ee:message>
		</ee:transform>
		<logger level="INFO" doc:name="Logger" message="#[payload]"/>
	</flow>
	<flow name="Get-List-of-Entities">
		<http:listener doc:name="Listener" config-ref="HTTP_Listener_config" path="/list"/>
		<successfactors:get-list-of-entities doc:name="Get list of entities" 
		 config-ref="SuccessFactors_Configuration"/>
		<ee:transform doc:name="Transform Message">
			<ee:message >
				<ee:set-payload ><![CDATA[%dw 2.0
output application/json
---
payload]]></ee:set-payload>
			</ee:message>
		</ee:transform>
		<logger level="INFO" doc:name="Logger" message="#[payload]"/>
	</flow>
	<flow name="Invoke-Uri" >
		<http:listener doc:name="Listener" config-ref="HTTP_Listener_config" path="/invokeuri"/>
		<ee:transform doc:name="Transform Message">
			<ee:message >
				<ee:set-payload ><![CDATA[%dw 2.0
output application/java
---
attributes.queryParams.uri]]></ee:set-payload>
			</ee:message>
		</ee:transform>
		<logger level="INFO" doc:name="Logger" message="#[payload]"/>
		<successfactors:invoke-uri doc:name="Invoke uri" config-ref="SuccessFactors_Configuration"
		 httpMethod="GET" uri="#[payload]"/>
		<ee:transform doc:name="Transform Message">
			<ee:message >
				<ee:set-payload ><![CDATA[%dw 2.0
output application/json
---
payload]]></ee:set-payload>
			</ee:message>
		</ee:transform>
		<logger level="INFO" doc:name="Logger" message="#[payload]"/>
	</flow>
	<flow name="Delete-Entity">
		<http:listener doc:name="Listener" config-ref="HTTP_Listener_config" path="/delete"/>
		<ee:transform doc:name="Transform Message">
			<ee:message >
				<ee:set-payload ><![CDATA[%dw 2.0
output application/java
---
{
	"effectiveStatus":"I",
	 "effectiveStartDate":"2018-07-08T00:00:00" as Date {class:"java.util.Date"}, 
	 "vendorCode":"ABC123ABC"
}]]></ee:set-payload>
			</ee:message>
		</ee:transform>
		<successfactors:create-entity entitySetName="VendorInfo" doc:name="Create entity" 
			config-ref="SuccessFactors_Configuration"/>
		<logger level="INFO" doc:name="Logger" message="#[payload]"/>
		<successfactors:delete-entity entitySetName="VendorInfo" doc:name="Delete entity" 
			config-ref="SuccessFactors_Configuration">
			<successfactors:key ><![CDATA[effectiveStartDate=datetime'2018-07-07T00:00:00',vendorCode='ABC123ABC']]></successfactors:key>
		</successfactors:delete-entity>
		<logger level="INFO" doc:name="Logger" />
	</flow>
</mule>
----

== See Also

* https://help.sap.com/cloud4hr[SuccessFactors HCM Suite site] and
https://help.sap.com/viewer/d599f15995d348a1b45ba5603e2aba9b/1711/en-US/03e1fc3791684367a6a76a614a2916de.html[About HCM Suite OData APIs].
* https://help.sap.com/viewer/d599f15995d348a1b45ba5603e2aba9b/1711/en-US/590d534a72e04e8ba5c49508b4e38b0a.html[SAP SuccessFactors ODATA API].
* https://forums.mulesoft.com[MuleSoft Forum].
* https://support.mulesoft.com[Contact MuleSoft Support].

= Using Logs

The Anypoint Monitoring aggregates your log files so you can manage, search for, filter, and analyze your logs. You can use aggregated logs in conjunction with monitoring to help identify causes and investigate failures quickly.

== Searching Logs

You can search for text in logs in a couple of ways:

* Typing your search query into the search field.
+
You can provide full terms, such as `"code 400"` to find  bad requests. For exact matches to multi-worded searches, you need to surround your search terms in quotation marks. Here are results from a `"code 400"` search:
+
image::log-search-string.png[Log Search]
+
You can also provide wildcards such as `payload=org.glassfish.grizzly*`. Here are the results of that search:
+
image::log-search-wildcard.png[Log Search Using a Wildcard]
+
* Using Elasticsearch Query DSL. The Logs UI provides a link to the query documentation.
+
image::log-filter-timestamp.png[Filter Using Elasticsearch Query]

== Creating a Search Filter

You can create, save, and use a filter to use when searching for logs that are important to your organization.

[cols="1,2,2", options="header"]
|===
| Filter | Description | Examples

|  `application`
| Full domain of the Mule app in CloudHub.
| `am-flights.us-e2.stgx.cloudhub.io`

|  `class`
| Java class that generates the log.
| `[am-flights].am-flights-api-httpListenerConfig.worker.34`

|  `environment`
| CloudHub environment name.
| `myEnv`

|  `environment type`
| CloudHub environment type
| `Sandbox`, `Design`, `Production`

|  `host`
| Host IP.
| `ip-172-25-175-175`

|  `log level`
| ALL, DEBUG, ERROR, FATAL, INFO, OFF, TRACE, WARN
| `INFO`

| `logger`
| Log4J Logger class
| `HttpListenerRegistry`

|  `message`
| Log4J message
| `No listener found for request: (POST)/zaraza`

| `timestamp`
| Timestamp on the log. Accepted formats: `MMM dd yyyy, HH:mm:ss.SSS`
a|
Supported time settings are `s` for seconds, `m` for minutes, `h` for hours, `d` for days, `w` for weeks, `M` for months, `y` for years, with `now` for relative times, for example:

* Last 5 minutes:	`now-5m`
* The day so far:	`now/d`
* This week:	`now/w`
* Week to date: `now/w`
* Previous Month: `now-1M/M`

| `worker`
| CloudHub worker ID.
| `0`, `1`
|===

=== Operators

You can use these operators when creating a search filter. For example, a

|===
| `is` | Available to all filters.
| `is not` | Available to all filters.
| `is between` | Available to `timestamp`.
| `is not between` | Available to `timestamp`.
| `exists` | Available to all filters.
| `does not exist` | Available to all filters.
|===

=== Adding Filter Columns to Logs

You can or remove a filter column to the Log display from the

=== Working with Filters

image::log-filter-actions.png[Filter Actions]

When you mouse over a filter, you can click a button for any of these actions:

//TODO: ADD DESCRIPTIONS
* Check (enable) or uncheck (disable) the filter.
* Pin or unpin the filter.
* Invert the search filter. For example, if the search is `log level IS ERROR`, the inversion is `log level IS NOT ERROR`
* Delete the filter.
* Edit the filter configuration.

== Getting the Log Count Over Time

The logs display the count of logs received over a configurable time period.

.Example: Automated Time Period
image::log-graph.png[Log Count (Automated)]

.Example: Selected Time Period
image::log-graph2.png[Log Count (Selected Time Period)]

== Viewing Log Data

TODO: Raw text and JSON formatted.

////
TODO: CUSTOM: need screenshot and functionality in place
QUESTION: How is automated time period determined?
QUESTION: How to set custom time period?
.Example: Custom Time Period
image::log-graph3.png[Log Count (Custom Time Period)]
////

= Autoscaling Application Resources in CloudHub

This topic describes how to use the autoscaling feature in CloudHub. To use the autoscaling feature, you must have an Anypoint Platform license that enables autoscaling. Contact your account representative to obtain the required license.

CloudHub enables you to configure how application resources are allocated in response to changes in usage. You can define policies that respond to CPU or memory usage thresholds by increasing or reducing the processing resources used by an application.

Policies define how application resources scale incrementally. To scale up to meet a very pronounced spike that requires scaling various steps, each step will take CloudHub the sum of the policy evaluation time plus the cool-down period. The maximum amount and size of workers available is determined by the resources allocated to your Anypoint Platform account. If multiple applications running in your account compete for limited resources, they are allocated on a first-come, first-serve basis.

== Configuring Autoscaling

To configure autoscaling, perform the following:

. Select the Applications tab in the Runtime Manager.
. Select an application deployed to CloudHub, then click Manage Application.
. Click Settings tab, then click the Autoscaling tab. 

From the Autoscaling tab, you can perform the following tasks:
+
* Create autoscaling policies
* View, activate or deactivate existing policies
* Create or delete a policy
* Create associated alerts

These tasks are described in the following sections.

== Creating an Autoscaling Policy

Changes in worker size or number are triggered when a policy meets its requirements. Policies can either be based upon CPU or Memory usage, and they can either modify worker numbers or worker size. All policies include scale-up and scale-down conditions.

[NOTE]
You can only apply one autoscaling policy per application.

. From the Autoscaling tab, click Create Policy
+
image:policy-form.png[form]

. Enter Name for your policy.
. Select whether the policy applies to CPU usage or memory usage.
+
The percentages displayed are the percentages of total memory or CPU allocated for the JVM being used. This percentage includes the memory being consumed by JVM itself.

. Determine the scaling rules of the policy. You must provide the following values both for the upscale and the downscale conditions:
+
* A usage percentage
* A period where this level must be sustained before the policy is applied
* A cool-down period that blocks this and other policies from affecting scaling from being applied

. Define the action performed when the policy is applied:
+
+ You can configure the policy to scale by either increasing the number of workers or amount of memory allocated to each worker. In either congfigureation, you must supply the minimum and maximum values.
+
* *Number of workers*: Determines the range of workers that can be allocated or deallocated. 
* *Worker size*: Specficies the range of worker sizes that can be allocated.

. Click Create Policy

After creating the policy it appears Autoscaling tab. From this tab you can create alerts, view alerts and perform other actions related to the policy.

== Editing an Existing Policy

To edit an existing policy, open the policies tab. Click the policy name and you will access the same menu that is used to create a new policy.

== Enabling or Disabling a Policy

To disable a running policy, open the policies tab and flip the switch in its corresponding *Status* field:

image:enable-policy.png[enable]

== Deleting a Policy

To delete an existing policy, go to the policies tab, then click its corresponding delete icon.

== Setting an Alert and Viewing Autoscaling History

Two specific types of Alerts can be set up for applications on CloudHub that warn you whenever a worker autoscaling event occurs. One alerts you about scale ups and the other about scale downs.

With this alert set, emails will be automatically sent to the addresses you provide whenever such an event occurs.

You can also see a full history of all of the times that the alert has been triggered. To see this, from the *Alerts* page, click on an alert name to open its corresponding panel:

image:alerts-history-autoscale.png[history]

== See Also

* link:/runtime-manager/alerts-on-runtime-manager[Alerts on Runtime Manager]
* link:/runtime-manager/managing-deployed-applications[Managing Deployed Applications]
* link:/runtime-manager/deploying-to-cloudhub[Deploy to CloudHub]
* link:/runtime-manager/cloudhub[CloudHub]
* link:/runtime-manager/deployment-strategies[Deployment Strategies]
* link:/runtime-manager/cloudhub-fabric[CloudHub Fabric]
* link:/runtime-manager/anypoint-platform-cli[Command Line Tools]
* link:/runtime-manager/secure-application-properties[Secure Application Properties]
* link:/runtime-manager/virtual-private-cloud[Virtual Private Cloud]

